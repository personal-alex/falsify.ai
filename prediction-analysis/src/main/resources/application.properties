# Prediction Analysis Module Configuration

# Server configuration
quarkus.http.port=8083

# Redis configuration (shared with other modules)
# Dev services will handle Redis in dev mode, only set for production
%dev.quarkus.redis.devservices.enabled=true
%prod.quarkus.redis.hosts=${REDIS_URL:redis://localhost:6379}

# Prediction Extractor Configuration
prediction.extractor.type=gemini
prediction.extractor.auto-fallback=true
prediction.extractor.prefer-llm=true

# Mock Prediction Extractor Configuration
prediction.mock.enabled=true
prediction.mock.processing-delay-ms=500
prediction.mock.min-predictions=1
prediction.mock.max-predictions=5
prediction.mock.min-confidence=0.3
prediction.mock.max-confidence=0.95

# LLM Configuration - Gemini as default
prediction.llm.enabled=true
prediction.llm.provider=gemini
prediction.llm.model=gemini-2.5-flash
prediction.llm.api-key=${GEMINI_API_KEY:}
# prediction.llm.api-url=https://generativelanguage.googleapis.com/v1
# prediction.llm.organization-id=your-org-id-here

# LLM Request Configuration
prediction.llm.timeout-seconds=120
prediction.llm.max-tokens=4000
prediction.llm.temperature=0.3
prediction.llm.top-p=1.0
prediction.llm.frequency-penalty=0.0
prediction.llm.presence-penalty=0.0

# LLM Retry and Rate Limiting
prediction.llm.retry-attempts=3
prediction.llm.retry-delay-seconds=1
prediction.llm.rate-limit-per-minute=60
prediction.llm.rate-limit-per-hour=1000

# LLM Fallback and Error Handling
prediction.llm.fallback-to-mock=true
prediction.llm.fail-fast=false

# LLM Cost Management
prediction.llm.max-cost-per-request=0.10
prediction.llm.daily-cost-limit=10.00

# LLM Caching
prediction.llm.enable-caching=true
prediction.llm.cache-ttl-hours=24

# LLM Batch Processing
prediction.llm.batch-mode=true
prediction.llm.max-batch-size=5
prediction.llm.batch-timeout-seconds=60
prediction.llm.async-timeout-seconds=120

# LLM Monitoring and Logging
prediction.llm.enable-metrics=true
prediction.llm.log-requests=true
prediction.llm.log-responses=false

# Analysis job configuration
prediction.analysis.max-concurrent-jobs=3
prediction.analysis.job-timeout-minutes=30

# Cleanup Configuration
analysis.cleanup.enabled=true
analysis.cleanup.retention-days=30
analysis.cleanup.batch-size=100

# WebSocket configuration
quarkus.websockets.max-frame-size=1048576

# Logging configuration
quarkus.log.level=INFO
quarkus.log.category."ai.falsify.prediction".level=DEBUG
quarkus.log.category."ai.falsify.crawlers.common".level=DEBUG
quarkus.log.category."dev.langchain4j".level=DEBUG
quarkus.log.category."root".level=INFO

# Console logging format for better debugging
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.console.level=DEBUG

# Test configuration (enable dev services for tests)
%test.quarkus.datasource.devservices.enabled=true
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1
%test.quarkus.hibernate-orm.enabled=true
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.redis.devservices.enabled=true
%test.crawler.common.redis.enable-redis=true

# Integration test configuration (enable services for IT tests)
%integration-test.quarkus.datasource.devservices.enabled=true
%integration-test.quarkus.datasource.db-kind=h2
%integration-test.quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1
%integration-test.quarkus.hibernate-orm.enabled=true
%integration-test.quarkus.hibernate-orm.database.generation=drop-and-create
%integration-test.quarkus.redis.devservices.enabled=true
%integration-test.crawler.common.redis.enable-redis=true