const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-kmiaMJtS.js","assets/vendor-WKs3_mFg.js","assets/primevue-DOZAb9Z2.js","assets/index-RZfVoOSm.css"])))=>i.map(i=>d[i]);
import{u as Pe,s as je,_ as we,A as Y,e as Me,a as Fe,b as $e,H as Le}from"./index-kmiaMJtS.js";import{B as Ee,j as Ie,p as Ne,g as N,r as he,_ as Te,t as ye}from"./primevue-DOZAb9Z2.js";import{h as v,f as p,m as ne,i as e,e as x,c as Be,z as G,t as c,M as _e,r as C,B as R,o as Ce,P as Se,w as ke,v as d,p as B,O as w,s as k,A as W,d as Z,j as xe,q as H}from"./vendor-WKs3_mFg.js";import{s as Ue}from"./index-BkHF1yR7.js";var He=`
    .p-progressspinner {
        position: relative;
        margin: 0 auto;
        width: 100px;
        height: 100px;
        display: inline-block;
    }

    .p-progressspinner::before {
        content: '';
        display: block;
        padding-top: 100%;
    }

    .p-progressspinner-spin {
        height: 100%;
        transform-origin: center center;
        width: 100%;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
        animation: p-progressspinner-rotate 2s linear infinite;
    }

    .p-progressspinner-circle {
        stroke-dasharray: 89, 200;
        stroke-dashoffset: 0;
        stroke: dt('progressspinner.colorOne');
        animation:
            p-progressspinner-dash 1.5s ease-in-out infinite,
            p-progressspinner-color 6s ease-in-out infinite;
        stroke-linecap: round;
    }

    @keyframes p-progressspinner-rotate {
        100% {
            transform: rotate(360deg);
        }
    }
    @keyframes p-progressspinner-dash {
        0% {
            stroke-dasharray: 1, 200;
            stroke-dashoffset: 0;
        }
        50% {
            stroke-dasharray: 89, 200;
            stroke-dashoffset: -35px;
        }
        100% {
            stroke-dasharray: 89, 200;
            stroke-dashoffset: -124px;
        }
    }
    @keyframes p-progressspinner-color {
        100%,
        0% {
            stroke: dt('progressspinner.color.one');
        }
        40% {
            stroke: dt('progressspinner.color.two');
        }
        66% {
            stroke: dt('progressspinner.color.three');
        }
        80%,
        90% {
            stroke: dt('progressspinner.color.four');
        }
    }
`,Oe={root:"p-progressspinner",spin:"p-progressspinner-spin",circle:"p-progressspinner-circle"},Je=Ee.extend({name:"progressspinner",style:He,classes:Oe}),ze={name:"BaseProgressSpinner",extends:Ie,props:{strokeWidth:{type:String,default:"2"},fill:{type:String,default:"none"},animationDuration:{type:String,default:"2s"}},style:Je,provide:function(){return{$pcProgressSpinner:this,$parentInstance:this}}},De={name:"ProgressSpinner",extends:ze,inheritAttrs:!1,computed:{svgStyle:function(){return{"animation-duration":this.animationDuration}}}},Ve=["fill","stroke-width"];function We(b,h,o,A,E,$){return p(),v("div",ne({class:b.cx("root"),role:"progressbar"},b.ptmi("root")),[(p(),v("svg",ne({class:b.cx("spin"),viewBox:"25 25 50 50",style:$.svgStyle},b.ptm("spin")),[e("circle",ne({class:b.cx("circle"),cx:"50",cy:"50",r:"20",fill:b.fill,"stroke-width":b.strokeWidth,strokeMiterlimit:"10"},b.ptm("circle")),null,16,Ve)],16))],16)}De.render=We;var Ye=`
    .p-progressbar {
        display: block;
        position: relative;
        overflow: hidden;
        height: dt('progressbar.height');
        background: dt('progressbar.background');
        border-radius: dt('progressbar.border.radius');
    }

    .p-progressbar-value {
        margin: 0;
        background: dt('progressbar.value.background');
    }

    .p-progressbar-label {
        color: dt('progressbar.label.color');
        font-size: dt('progressbar.label.font.size');
        font-weight: dt('progressbar.label.font.weight');
    }

    .p-progressbar-determinate .p-progressbar-value {
        height: 100%;
        width: 0%;
        position: absolute;
        display: none;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        transition: width 1s ease-in-out;
    }

    .p-progressbar-determinate .p-progressbar-label {
        display: inline-flex;
    }

    .p-progressbar-indeterminate .p-progressbar-value::before {
        content: '';
        position: absolute;
        background: inherit;
        inset-block-start: 0;
        inset-inline-start: 0;
        inset-block-end: 0;
        will-change: inset-inline-start, inset-inline-end;
        animation: p-progressbar-indeterminate-anim 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    }

    .p-progressbar-indeterminate .p-progressbar-value::after {
        content: '';
        position: absolute;
        background: inherit;
        inset-block-start: 0;
        inset-inline-start: 0;
        inset-block-end: 0;
        will-change: inset-inline-start, inset-inline-end;
        animation: p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;
        animation-delay: 1.15s;
    }

    @keyframes p-progressbar-indeterminate-anim {
        0% {
            inset-inline-start: -35%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
        100% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
    }
    @-webkit-keyframes p-progressbar-indeterminate-anim {
        0% {
            inset-inline-start: -35%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
        100% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
    }

    @keyframes p-progressbar-indeterminate-anim-short {
        0% {
            inset-inline-start: -200%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
        100% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
    }
    @-webkit-keyframes p-progressbar-indeterminate-anim-short {
        0% {
            inset-inline-start: -200%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
        100% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
    }
`,qe={root:function(h){var o=h.instance;return["p-progressbar p-component",{"p-progressbar-determinate":o.determinate,"p-progressbar-indeterminate":o.indeterminate}]},value:"p-progressbar-value",label:"p-progressbar-label"},Ge=Ee.extend({name:"progressbar",style:Ye,classes:qe}),Ke={name:"BaseProgressBar",extends:Ie,props:{value:{type:Number,default:null},mode:{type:String,default:"determinate"},showValue:{type:Boolean,default:!0}},style:Ge,provide:function(){return{$pcProgressBar:this,$parentInstance:this}}},Re={name:"ProgressBar",extends:Ke,inheritAttrs:!1,computed:{progressStyle:function(){return{width:this.value+"%",display:"flex"}},indeterminate:function(){return this.mode==="indeterminate"},determinate:function(){return this.mode==="determinate"},dataP:function(){return Ne({determinate:this.determinate,indeterminate:this.indeterminate})}}},Qe=["aria-valuenow","data-p"],Ze=["data-p"],Xe=["data-p"],et=["data-p"];function tt(b,h,o,A,E,$){return p(),v("div",ne({role:"progressbar",class:b.cx("root"),"aria-valuemin":"0","aria-valuenow":b.value,"aria-valuemax":"100","data-p":$.dataP},b.ptmi("root")),[$.determinate?(p(),v("div",ne({key:0,class:b.cx("value"),style:$.progressStyle,"data-p":$.dataP},b.ptm("value")),[b.value!=null&&b.value!==0&&b.showValue?(p(),v("div",ne({key:0,class:b.cx("label"),"data-p":$.dataP},b.ptm("label")),[Be(b.$slots,"default",{},function(){return[G(c(b.value+"%"),1)]})],16,Xe)):x("",!0)],16,Ze)):$.indeterminate?(p(),v("div",ne({key:1,class:b.cx("value"),"data-p":$.dataP},b.ptm("value")),null,16,et)):x("",!0)],16,Qe)}Re.render=tt;const st={class:"metrics-component"},at={class:"flex justify-content-between align-items-center mb-4"},ot={class:"flex align-items-center gap-2"},rt={key:0,class:"flex align-items-center justify-content-center p-4"},nt={key:1,class:"text-center p-4"},lt={class:"flex align-items-center"},it={class:"text-sm"},dt={key:2,class:"text-center p-4"},ct={class:"text-600"},ut={class:"text-sm"},pt={key:3,class:"metrics-content"},vt={class:"grid mb-4"},mt={class:"col-12 md:col-3"},ft={class:"metric-card surface-card p-3 border-round shadow-1"},bt={class:"flex align-items-center justify-content-between"},gt={class:"text-900 text-2xl font-semibold"},ht={class:"flex align-items-center mt-1"},yt={class:"col-12 md:col-3"},wt={class:"metric-card surface-card p-3 border-round shadow-1"},_t={class:"flex align-items-center justify-content-between"},xt={class:"text-900 text-2xl font-semibold"},$t={class:"flex align-items-center mt-1"},kt={class:"col-12 md:col-3"},Ct={class:"metric-card surface-card p-3 border-round shadow-1"},St={class:"flex align-items-center justify-content-between"},Dt={class:"text-900 text-2xl font-semibold"},Tt={class:"flex align-items-center mt-1"},jt={class:"col-12 md:col-3"},Et={class:"metric-card surface-card p-3 border-round shadow-1"},It={class:"flex align-items-center justify-content-between"},Rt={class:"text-900 text-2xl font-semibold"},At={class:"flex align-items-center mt-1"},Pt={class:"grid"},Mt={class:"col-12 lg:col-6"},Ft={class:"chart-container",style:{height:"300px"}},Lt={key:1,class:"flex align-items-center justify-content-center h-full text-600"},Nt={class:"col-12 lg:col-6"},Bt={class:"chart-container",style:{height:"300px"}},Ut={key:1,class:"flex align-items-center justify-content-center h-full text-600"},Ht={class:"col-12 lg:col-6"},Ot={class:"chart-container",style:{height:"300px"}},Jt={key:1,class:"flex align-items-center justify-content-center h-full text-600"},zt={class:"col-12 lg:col-6"},Vt={class:"chart-container",style:{height:"300px"}},Wt={key:1,class:"flex align-items-center justify-content-center h-full text-600"},Yt={key:0,class:"text-center mt-4"},qt={class:"text-600"},Gt=_e({__name:"MetricsComponent",props:{crawlerId:{},autoRefresh:{type:Boolean,default:!0},refreshInterval:{default:3e4}},setup(b){const h=b,o=C(null),A=C(!1),E=C(null),$=C(null),L=C("1h");let m=null;const _=[{label:"1 Hour",value:"1h"},{label:"6 Hours",value:"6h"},{label:"24 Hours",value:"1d"},{label:"7 Days",value:"7d"},{label:"30 Days",value:"30d"}],M=R(()=>o.value&&(o.value.articlesProcessed>0||o.value.errorCount>0||o.value.trendsData&&o.value.trendsData.length>0)),S=Pe(),D=()=>{const t=S.isDarkMode;return{primary:t?"#60a5fa":"#3b82f6",success:t?"#4ade80":"#22c55e",warning:t?"#fbbf24":"#f59e0b",danger:t?"#f87171":"#ef4444",info:t?"#38bdf8":"#0ea5e9",surface:t?"#374151":"#f8fafc",text:t?"#f9fafb":"#1f2937",textSecondary:t?"#d1d5db":"#6b7280"}},T=R(()=>{var i;if(!((i=o.value)!=null&&i.trendsData)||o.value.trendsData.length===0)return null;const t=o.value.trendsData,s=D();return{labels:t.map(y=>I(y.timestamp)),datasets:[{label:"Articles Processed",data:t.map(y=>y.articlesProcessed),borderColor:s.primary,backgroundColor:`${s.primary}20`,fill:!0,tension:.4,pointBackgroundColor:s.primary,pointBorderColor:s.primary,pointHoverBackgroundColor:s.primary,pointHoverBorderColor:"#ffffff",pointRadius:4,pointHoverRadius:6}]}}),O=R(()=>{var i;if(!((i=o.value)!=null&&i.trendsData)||o.value.trendsData.length===0)return null;const t=o.value.trendsData,s=D();return{labels:t.map(y=>I(y.timestamp)),datasets:[{label:"Success Rate (%)",data:t.map(y=>y.successRate),borderColor:s.success,backgroundColor:`${s.success}20`,fill:!0,tension:.4,pointBackgroundColor:s.success,pointBorderColor:s.success,pointHoverBackgroundColor:s.success,pointHoverBorderColor:"#ffffff",pointRadius:4,pointHoverRadius:6}]}}),l=R(()=>{var i;if(!((i=o.value)!=null&&i.trendsData)||o.value.trendsData.length===0)return null;const t=o.value.trendsData,s=D();return{labels:t.map(y=>I(y.timestamp)),datasets:[{label:"Processing Time (ms)",data:t.map(y=>y.processingTimeMs),borderColor:s.warning,backgroundColor:`${s.warning}20`,fill:!0,tension:.4,pointBackgroundColor:s.warning,pointBorderColor:s.warning,pointHoverBackgroundColor:s.warning,pointHoverBorderColor:"#ffffff",pointRadius:4,pointHoverRadius:6}]}}),n=R(()=>{var i;if(!((i=o.value)!=null&&i.trendsData)||o.value.trendsData.length===0)return null;const t=o.value.trendsData,s=D();return{labels:t.map(y=>I(y.timestamp)),datasets:[{label:"Error Count",data:t.map(y=>y.errorCount),backgroundColor:`${s.danger}CC`,borderColor:s.danger,borderWidth:2,borderRadius:4,borderSkipped:!1,hoverBackgroundColor:s.danger,hoverBorderColor:s.danger}]}}),g=()=>{const t=D();return{responsive:!0,maintainAspectRatio:!1,animation:{duration:750,easing:"easeInOutQuart"},plugins:{legend:{display:!0,position:"top",align:"end",labels:{usePointStyle:!0,pointStyle:"circle",padding:20,color:t.text,font:{size:12,family:"Inter, system-ui, sans-serif"}}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:t.surface,titleColor:t.text,bodyColor:t.text,borderColor:t.primary,borderWidth:1,cornerRadius:8,displayColors:!0,padding:12,titleFont:{size:13,weight:"bold"},bodyFont:{size:12},callbacks:{title:s=>q(s[0].label)}}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:t.textSecondary,font:{size:11}}},y:{display:!0,beginAtZero:!0,grid:{color:`${t.textSecondary}20`,drawBorder:!1},ticks:{color:t.textSecondary,font:{size:11}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{line:{borderWidth:3},point:{hoverBorderWidth:3}}}},j=R(()=>({...g(),plugins:{...g().plugins,tooltip:{...g().plugins.tooltip,callbacks:{...g().plugins.tooltip.callbacks,label:t=>`Articles: ${ee(t.parsed.y)}`}}}})),P=R(()=>({...g(),scales:{...g().scales,y:{...g().scales.y,max:100,ticks:{...g().scales.y.ticks,callback:t=>`${t}%`}}},plugins:{...g().plugins,tooltip:{...g().plugins.tooltip,callbacks:{...g().plugins.tooltip.callbacks,label:t=>`Success Rate: ${ue(t.parsed.y)}`}}}})),F=R(()=>({...g(),plugins:{...g().plugins,tooltip:{...g().plugins.tooltip,callbacks:{...g().plugins.tooltip.callbacks,label:t=>`Processing Time: ${u(t.parsed.y)}`}}}})),J=R(()=>({...g(),plugins:{...g().plugins,tooltip:{...g().plugins.tooltip,callbacks:{...g().plugins.tooltip.callbacks,label:t=>`Errors: ${ee(t.parsed.y)}`}}}})),U=async()=>{try{A.value=!0,E.value=null;const{ApiService:t}=await Te(async()=>{const{ApiService:i}=await import("./index-kmiaMJtS.js").then(y=>y.d);return{ApiService:i}},__vite__mapDeps([0,1,2,3]));let s;if(L.value!=="1h"){const i=X(L.value);s=await t.getCrawlerMetricsHistory(h.crawlerId,i)}else s=await t.getCrawlerMetrics(h.crawlerId);o.value=s,$.value=new Date}catch(t){console.error("Failed to load metrics:",t),E.value=t instanceof Error?t.message:"Failed to load metrics"}finally{A.value=!1}},X=t=>{switch(t){case"1h":return 1;case"6h":return 6;case"1d":return 24;case"7d":return 168;case"30d":return 720;default:return 24}},z=async()=>{await U()},le=()=>{U()},K=t=>{try{const s=document.querySelector(".chart-container canvas");if(!s){console.warn("Chart canvas not found for export");return}const i=document.createElement("a");i.download=`${h.crawlerId}-${t}-${L.value}-${new Date().toISOString().split("T")[0]}.png`,i.href=s.toDataURL("image/png"),i.click()}catch(s){console.error("Failed to export chart:",s)}},ie=()=>{["articles","success-rate","processing-time","error-count"].forEach((s,i)=>{setTimeout(()=>{K(s)},i*500)})},de=()=>{h.autoRefresh&&h.refreshInterval>0&&(m=setInterval(()=>{A.value||U()},h.refreshInterval))},ce=()=>{m&&(clearInterval(m),m=null)},ee=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),ue=t=>`${t.toFixed(1)}%`,u=t=>t<1e3?`${t}ms`:t<6e4?`${(t/1e3).toFixed(1)}s`:`${(t/6e4).toFixed(1)}m`,r=t=>{const s=typeof t=="string"?new Date(t):t,y=new Date().getTime()-s.getTime(),ae=Math.floor(y/1e3),oe=Math.floor(ae/60);return ae<60?`${ae}s ago`:oe<60?`${oe}m ago`:s.toLocaleString()},I=t=>{const s=new Date(t),i=L.value;return i==="1h"||i==="6h"?s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i==="1d"?s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):s.toLocaleDateString([],{month:"short",day:"numeric"})},q=t=>t,V=(t,s=!1)=>{if(t==null)return"pi pi-minus";const i=s?t<0:t>0,y=s?t>0:t<0;return i?"pi pi-arrow-up":y?"pi pi-arrow-down":"pi pi-minus"},Q=(t,s=!1)=>{if(t==null)return"text-600";const i=s?t<0:t>0,y=s?t>0:t<0;return i?"text-green-500":y?"text-red-500":"text-600"},te=t=>{if(t==null)return"No change";const s=Math.abs(t),i=t>0?"+":"";return s<1?`${i}${(t*100).toFixed(1)}%`:`${i}${t.toFixed(1)}`},pe=t=>t>=95?"success-rate-excellent":t>=85?"success-rate-good":t>=70?"success-rate-warning":"success-rate-poor";let se=null;const a=async()=>{try{const{getWebSocketService:t}=await Te(async()=>{const{getWebSocketService:i}=await import("./index-kmiaMJtS.js").then(y=>y.w);return{getWebSocketService:i}},__vite__mapDeps([0,1,2,3]));se=t().onMetricsUpdate(i=>{i.crawlerId===h.crawlerId&&o.value&&(o.value.articlesProcessed=i.metrics.articlesProcessed,o.value.successRate=i.metrics.successRate,o.value.averageProcessingTimeMs=i.metrics.averageProcessingTime,o.value.errorCount=i.metrics.errorCount,$.value=new Date)})}catch(t){console.warn("Failed to setup WebSocket listeners:",t)}};return Ce(()=>{U(),de(),a()}),Se(()=>{ce(),se&&se()}),ke(()=>h.crawlerId,()=>{U()}),ke(()=>h.autoRefresh,t=>{t?de():ce()}),(t,s)=>{var y,ae,oe,ve,be,me,ge,re,fe;const i=xe("tooltip");return p(),v("div",st,[e("div",at,[s[5]||(s[5]=e("h5",{class:"flex align-items-center m-0"},[e("i",{class:"pi pi-chart-line mr-2"}),G(" Metrics ")],-1)),e("div",ot,[d(w(Ue),{modelValue:L.value,"onUpdate:modelValue":s[0]||(s[0]=f=>L.value=f),options:_,optionLabel:"label",optionValue:"value",placeholder:"Select time range",class:"w-10rem",onChange:le},null,8,["modelValue"]),B(d(w(N),{icon:"pi pi-refresh",class:"p-button-text p-button-sm",loading:A.value,onClick:z},null,8,["loading"]),[[i,"Refresh metrics",void 0,{top:!0}]]),B(d(w(N),{icon:"pi pi-download",class:"p-button-text p-button-sm",onClick:ie,disabled:!M.value},null,8,["disabled"]),[[i,"Export charts",void 0,{top:!0}]])])]),A.value&&!o.value?(p(),v("div",rt,[d(w(De),{size:"small"}),s[6]||(s[6]=e("span",{class:"ml-2 text-600"},"Loading metrics...",-1))])):E.value?(p(),v("div",nt,[d(w(je),{severity:"error",closable:!1},{default:k(()=>[e("div",lt,[s[8]||(s[8]=e("i",{class:"pi pi-exclamation-triangle mr-2"},null,-1)),e("div",null,[s[7]||(s[7]=e("div",{class:"font-medium"},"Failed to load metrics",-1)),e("div",it,c(E.value),1)])])]),_:1}),d(w(N),{icon:"pi pi-refresh",label:"Retry",class:"p-button-sm mt-2",onClick:z})])):!o.value||!M.value?(p(),v("div",dt,[e("div",ct,[s[9]||(s[9]=e("i",{class:"pi pi-chart-line text-4xl mb-3"},null,-1)),s[10]||(s[10]=e("div",{class:"text-lg font-medium"},"No metrics data available",-1)),e("div",ut,c($.value?`Last updated: ${r($.value)}`:"No data collected yet"),1)])])):(p(),v("div",pt,[e("div",vt,[e("div",mt,[e("div",ft,[e("div",bt,[e("div",null,[s[11]||(s[11]=e("div",{class:"text-600 text-sm mb-1"},"Articles Processed",-1)),e("div",gt,c(ee(o.value.articlesProcessed)),1),e("div",ht,[e("i",{class:W([V((y=o.value.trends)==null?void 0:y.articlesProcessed),"text-sm mr-1"])},null,2),e("span",{class:W([Q((ae=o.value.trends)==null?void 0:ae.articlesProcessed),"text-sm font-medium"])},c(te((oe=o.value.trends)==null?void 0:oe.articlesProcessed)),3)])]),s[12]||(s[12]=e("div",{class:"metric-icon"},[e("i",{class:"pi pi-file text-2xl text-blue-500"})],-1))])])]),e("div",yt,[e("div",wt,[e("div",_t,[e("div",null,[s[13]||(s[13]=e("div",{class:"text-600 text-sm mb-1"},"Success Rate",-1)),e("div",xt,c(ue(o.value.successRate)),1),e("div",$t,[d(w(Re),{value:o.value.successRate,class:W(["w-full",pe(o.value.successRate)]),style:{height:"4px"}},null,8,["value","class"])])]),s[14]||(s[14]=e("div",{class:"metric-icon"},[e("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1))])])]),e("div",kt,[e("div",Ct,[e("div",St,[e("div",null,[s[15]||(s[15]=e("div",{class:"text-600 text-sm mb-1"},"Avg Processing Time",-1)),e("div",Dt,c(u(o.value.averageProcessingTimeMs)),1),e("div",Tt,[e("i",{class:W([V((ve=o.value.trends)==null?void 0:ve.averageProcessingTime,!0),"text-sm mr-1"])},null,2),e("span",{class:W([Q((be=o.value.trends)==null?void 0:be.averageProcessingTime,!0),"text-sm font-medium"])},c(te((me=o.value.trends)==null?void 0:me.averageProcessingTime)),3)])]),s[16]||(s[16]=e("div",{class:"metric-icon"},[e("i",{class:"pi pi-clock text-2xl text-orange-500"})],-1))])])]),e("div",jt,[e("div",Et,[e("div",It,[e("div",null,[s[17]||(s[17]=e("div",{class:"text-600 text-sm mb-1"},"Error Count",-1)),e("div",Rt,c(ee(o.value.errorCount)),1),e("div",At,[e("i",{class:W([V((ge=o.value.trends)==null?void 0:ge.errorCount,!0),"text-sm mr-1"])},null,2),e("span",{class:W([Q((re=o.value.trends)==null?void 0:re.errorCount,!0),"text-sm font-medium"])},c(te((fe=o.value.trends)==null?void 0:fe.errorCount)),3)])]),s[18]||(s[18]=e("div",{class:"metric-icon"},[e("i",{class:"pi pi-exclamation-triangle text-2xl text-red-500"})],-1))])])])]),e("div",Pt,[e("div",Mt,[d(w(he),{class:"chart-panel",toggleable:!0},{header:k(()=>s[19]||(s[19]=[e("div",{class:"flex align-items-center"},[e("i",{class:"pi pi-chart-line mr-2 text-primary"}),e("span",{class:"font-semibold"},"Articles Processed Over Time")],-1)])),icons:k(()=>[B(d(w(N),{icon:"pi pi-download",class:"p-button-text p-button-sm",onClick:s[1]||(s[1]=f=>K("articles"))},null,512),[[i,"Export chart",void 0,{top:!0}]])]),default:k(()=>[e("div",Ft,[T.value?(p(),Z(w(ye),{key:0,type:"line",data:T.value,options:j.value,class:"chart-responsive"},null,8,["data","options"])):(p(),v("div",Lt,s[20]||(s[20]=[e("i",{class:"pi pi-chart-line mr-2"},null,-1),G(" No chart data available ",-1)])))])]),_:1})]),e("div",Nt,[d(w(he),{class:"chart-panel",toggleable:!0},{header:k(()=>s[21]||(s[21]=[e("div",{class:"flex align-items-center"},[e("i",{class:"pi pi-chart-bar mr-2 text-green-500"}),e("span",{class:"font-semibold"},"Success Rate Trend")],-1)])),icons:k(()=>[B(d(w(N),{icon:"pi pi-download",class:"p-button-text p-button-sm",onClick:s[2]||(s[2]=f=>K("success-rate"))},null,512),[[i,"Export chart",void 0,{top:!0}]])]),default:k(()=>[e("div",Bt,[O.value?(p(),Z(w(ye),{key:0,type:"line",data:O.value,options:P.value,class:"chart-responsive"},null,8,["data","options"])):(p(),v("div",Ut,s[22]||(s[22]=[e("i",{class:"pi pi-chart-bar mr-2"},null,-1),G(" No chart data available ",-1)])))])]),_:1})]),e("div",Ht,[d(w(he),{class:"chart-panel",toggleable:!0},{header:k(()=>s[23]||(s[23]=[e("div",{class:"flex align-items-center"},[e("i",{class:"pi pi-clock mr-2 text-orange-500"}),e("span",{class:"font-semibold"},"Processing Time Trend")],-1)])),icons:k(()=>[B(d(w(N),{icon:"pi pi-download",class:"p-button-text p-button-sm",onClick:s[3]||(s[3]=f=>K("processing-time"))},null,512),[[i,"Export chart",void 0,{top:!0}]])]),default:k(()=>[e("div",Ot,[l.value?(p(),Z(w(ye),{key:0,type:"line",data:l.value,options:F.value,class:"chart-responsive"},null,8,["data","options"])):(p(),v("div",Jt,s[24]||(s[24]=[e("i",{class:"pi pi-clock mr-2"},null,-1),G(" No chart data available ",-1)])))])]),_:1})]),e("div",zt,[d(w(he),{class:"chart-panel",toggleable:!0},{header:k(()=>s[25]||(s[25]=[e("div",{class:"flex align-items-center"},[e("i",{class:"pi pi-exclamation-triangle mr-2 text-red-500"}),e("span",{class:"font-semibold"},"Error Count Trend")],-1)])),icons:k(()=>[B(d(w(N),{icon:"pi pi-download",class:"p-button-text p-button-sm",onClick:s[4]||(s[4]=f=>K("error-count"))},null,512),[[i,"Export chart",void 0,{top:!0}]])]),default:k(()=>[e("div",Vt,[n.value?(p(),Z(w(ye),{key:0,type:"bar",data:n.value,options:J.value,class:"chart-responsive"},null,8,["data","options"])):(p(),v("div",Wt,s[26]||(s[26]=[e("i",{class:"pi pi-exclamation-triangle mr-2"},null,-1),G(" No chart data available ",-1)])))])]),_:1})])]),$.value?(p(),v("div",Yt,[e("small",qt," Last updated: "+c(r($.value)),1)])):x("",!0)]))])}}}),Kt=we(Gt,[["__scopeId","data-v-c973af45"]]),Qt={class:"job-detail-modal"},Zt={class:"job-overview"},Xt={class:"job-header"},es={class:"job-title"},ts={key:0,class:"job-actions"},ss={class:"job-metadata"},as={class:"metadata-grid"},os={class:"metadata-item"},rs={class:"metadata-item"},ns={class:"metadata-item"},ls={key:0,class:"metadata-item"},is={class:"metadata-item"},ds={key:1,class:"metadata-item"},cs={class:"job-progress"},us={class:"progress-grid"},ps={class:"progress-item"},vs={class:"progress-header"},ms={class:"progress-value"},fs={class:"progress-item"},bs={class:"progress-header"},gs={class:"progress-value"},hs={class:"progress-item"},ys={class:"progress-header"},ws={class:"progress-value"},_s={class:"progress-item"},xs={class:"progress-header"},$s={class:"progress-value"},ks={class:"statistics-summary"},Cs={class:"summary-item"},Ss={class:"summary-value"},Ds={key:0,class:"summary-item"},Ts={class:"summary-value"},js={key:1,class:"summary-item"},Es={class:"summary-value"},Is={class:"job-activity"},Rs={class:"activity-display"},As={class:"activity-text"},Ps={key:0,class:"pi pi-spin pi-spinner"},Ms={key:1,class:"pi pi-check-circle"},Fs={key:2,class:"pi pi-times-circle"},Ls={key:3,class:"pi pi-ban"},Ns={key:0,class:"activity-time"},Bs={key:0,class:"job-error"},Us={class:"error-display"},Hs={class:"error-content"},Os=_e({__name:"JobDetailModal",props:{job:{}},emits:["refresh","cancel"],setup(b,{emit:h}){const o=b,A=h,E=C(!1),$=R(()=>{if(o.job.articlesProcessed>0&&o.job.elapsedTimeMs>0){const l=o.job.elapsedTimeMs/o.job.articlesProcessed;return D({elapsedTimeMs:l})}return null}),L=l=>{switch(l){case"RUNNING":return"info";case"COMPLETED":return"success";case"FAILED":return"danger";case"CANCELLED":return"warning";default:return"secondary"}},m=l=>`job-status-${l.toLowerCase()}`,_=l=>o.job.totalArticlesAttempted===0?0:(l==="processed"?o.job.articlesProcessed:l==="skipped"?o.job.articlesSkipped:o.job.articlesFailed)/o.job.totalArticlesAttempted*100,M=l=>new Date(l).toLocaleString(),S=l=>{const n=new Date(l),j=new Date().getTime()-n.getTime(),P=Math.floor(j/1e3),F=Math.floor(P/60),J=Math.floor(F/60);return P<60?`${P} seconds ago`:F<60?`${F} minutes ago`:J<24?`${J} hours ago`:n.toLocaleString()},D=l=>{const n=l.durationMs||l.elapsedTimeMs;if(!n)return"-";const g=Math.floor(n/1e3),j=Math.floor(g/60),P=Math.floor(j/60),F=Math.floor(P/24);return F>0?`${F}d ${P%24}h ${j%60}m`:P>0?`${P}h ${j%60}m ${g%60}s`:j>0?`${j}m ${g%60}s`:`${g}s`},T=l=>{const n=Math.floor(l/1e3),g=Math.floor(n/60),j=Math.floor(g/60);return j>0?`${j}h ${g%60}m ${n%60}s`:g>0?`${g}m ${n%60}s`:`${n}s`},O=()=>{A("cancel",o.job.jobId),E.value=!1};return(l,n)=>{const g=H("Badge"),j=H("Button"),P=H("Divider"),F=H("ProgressBar"),J=H("Message"),U=H("Dialog"),X=xe("tooltip");return p(),v("div",Qt,[e("div",Zt,[e("div",Xt,[e("div",es,[e("h4",null,c(l.job.jobId),1),d(g,{value:l.job.status,severity:L(l.job.status),class:W(m(l.job.status))},null,8,["value","severity","class"])]),l.job.status==="RUNNING"?(p(),v("div",ts,[B(d(j,{icon:"pi pi-refresh",severity:"secondary",size:"small",onClick:n[0]||(n[0]=z=>l.$emit("refresh"))},null,512),[[X,"Refresh",void 0,{top:!0}]]),B(d(j,{icon:"pi pi-times",severity:"danger",size:"small",onClick:n[1]||(n[1]=z=>E.value=!0)},null,512),[[X,"Cancel job",void 0,{top:!0}]])])):x("",!0)]),e("div",ss,[e("div",as,[e("div",os,[n[4]||(n[4]=e("label",null,"Crawler ID",-1)),e("span",null,c(l.job.crawlerId),1)]),e("div",rs,[n[5]||(n[5]=e("label",null,"Request ID",-1)),e("span",null,c(l.job.requestId||"N/A"),1)]),e("div",ns,[n[6]||(n[6]=e("label",null,"Started",-1)),e("span",null,c(M(l.job.startTime)),1)]),l.job.endTime?(p(),v("div",ls,[n[7]||(n[7]=e("label",null,"Ended",-1)),e("span",null,c(M(l.job.endTime)),1)])):x("",!0),e("div",is,[n[8]||(n[8]=e("label",null,"Duration",-1)),e("span",null,c(D(l.job)),1)]),l.job.lastUpdated?(p(),v("div",ds,[n[9]||(n[9]=e("label",null,"Last Updated",-1)),e("span",null,c(M(l.job.lastUpdated)),1)])):x("",!0)])])]),d(P),e("div",cs,[n[20]||(n[20]=e("h5",null,"Progress & Statistics",-1)),e("div",us,[e("div",ps,[e("div",vs,[n[10]||(n[10]=e("span",{class:"progress-label"},"Articles Processed",-1)),e("span",ms,c(l.job.articlesProcessed),1)]),d(F,{value:_("processed"),showValue:!1,class:"progress-bar success"},null,8,["value"])]),e("div",fs,[e("div",bs,[n[11]||(n[11]=e("span",{class:"progress-label"},"Articles Skipped",-1)),e("span",gs,c(l.job.articlesSkipped),1)]),d(F,{value:_("skipped"),showValue:!1,class:"progress-bar warning"},null,8,["value"])]),e("div",hs,[e("div",ys,[n[12]||(n[12]=e("span",{class:"progress-label"},"Articles Failed",-1)),e("span",ws,c(l.job.articlesFailed),1)]),d(F,{value:_("failed"),showValue:!1,class:"progress-bar danger"},null,8,["value"])]),e("div",_s,[e("div",xs,[n[13]||(n[13]=e("span",{class:"progress-label"},"Success Rate",-1)),e("span",$s,c(l.job.successRate.toFixed(1))+"%",1)]),d(F,{value:l.job.successRate,showValue:!1,class:"progress-bar info"},null,8,["value"])])]),e("div",ks,[e("div",Cs,[n[15]||(n[15]=e("i",{class:"pi pi-chart-bar"},null,-1)),e("div",null,[n[14]||(n[14]=e("span",{class:"summary-label"},"Total Attempted",-1)),e("span",Ss,c(l.job.totalArticlesAttempted),1)])]),l.job.status==="RUNNING"?(p(),v("div",Ds,[n[17]||(n[17]=e("i",{class:"pi pi-clock"},null,-1)),e("div",null,[n[16]||(n[16]=e("span",{class:"summary-label"},"Elapsed Time",-1)),e("span",Ts,c(T(l.job.elapsedTimeMs)),1)])])):x("",!0),$.value?(p(),v("div",js,[n[19]||(n[19]=e("i",{class:"pi pi-stopwatch"},null,-1)),e("div",null,[n[18]||(n[18]=e("span",{class:"summary-label"},"Avg. Processing Time",-1)),e("span",Es,c($.value),1)])])):x("",!0)])]),d(P),e("div",Is,[n[21]||(n[21]=e("h5",null,"Current Activity",-1)),e("div",Rs,[e("div",As,[l.job.status==="RUNNING"?(p(),v("i",Ps)):l.job.status==="COMPLETED"?(p(),v("i",Ms)):l.job.status==="FAILED"?(p(),v("i",Fs)):l.job.status==="CANCELLED"?(p(),v("i",Ls)):x("",!0),e("span",null,c(l.job.currentActivity||"No activity information"),1)]),l.job.lastUpdated?(p(),v("div",Ns," Last updated: "+c(S(l.job.lastUpdated)),1)):x("",!0)])]),l.job.errorMessage?(p(),v("div",Bs,[d(P),n[22]||(n[22]=e("h5",null,"Error Details",-1)),e("div",Us,[d(J,{severity:"error",closable:!1},{default:k(()=>[e("div",Hs,[e("pre",null,c(l.job.errorMessage),1)])]),_:1})])])):x("",!0),d(U,{visible:E.value,"onUpdate:visible":n[3]||(n[3]=z=>E.value=z),header:"Cancel Job",modal:"",style:{width:"25rem"}},{footer:k(()=>[d(j,{label:"No",severity:"secondary",onClick:n[2]||(n[2]=z=>E.value=!1)}),d(j,{label:"Yes, Cancel Job",severity:"danger",onClick:O})]),default:k(()=>[n[23]||(n[23]=e("div",{class:"cancel-confirmation"},[e("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"2rem",color:"var(--orange-500)"}}),e("div",null,[e("p",null,"Are you sure you want to cancel this job?"),e("p",{class:"cancel-warning"},"This action cannot be undone.")])],-1))]),_:1,__:[23]},8,["visible"])])}}}),Js=we(Os,[["__scopeId","data-v-74647e78"]]),zs={class:"job-history"},Vs={class:"job-history-header"},Ws={class:"job-history-actions"},Ys={class:"job-history-content"},qs={class:"job-start-time"},Gs={class:"job-articles"},Ks={class:"articles-processed"},Qs={key:0,class:"articles-failed"},Zs={class:"success-rate"},Xs={class:"success-rate-text"},ea={class:"job-duration"},ta=["title"],sa={class:"job-actions"},aa={class:"filter-form"},oa={class:"field"},ra={class:"field"},na={class:"field"},la={class:"field"},ia=_e({__name:"JobHistory",props:{crawlerId:{},showPagination:{type:Boolean,default:!1},pageSize:{default:10},showActivityColumn:{type:Boolean,default:!0},autoRefresh:{type:Boolean,default:!0},refreshInterval:{default:3e4}},setup(b){const h=b,o=C([]),A=C(!1),E=C(!1),$=C(null),L=C(0),m=C(0),_=C("startTime"),M=C(-1),S=C(!1),D=C({status:[],dateFrom:void 0,dateTo:void 0,searchTerm:""}),T=C({}),O=C(!1),l=C(null);let n=null,g=[];const j=[{label:"Running",value:"RUNNING"},{label:"Completed",value:"COMPLETED"},{label:"Failed",value:"FAILED"},{label:"Cancelled",value:"CANCELLED"}],P=R(()=>{let a=[...o.value];if(T.value.status&&T.value.status.length>0&&(a=a.filter(t=>T.value.status.includes(t.status))),T.value.dateFrom){const t=new Date(T.value.dateFrom);a=a.filter(s=>new Date(s.startTime)>=t)}if(T.value.dateTo){const t=new Date(T.value.dateTo);t.setHours(23,59,59,999),a=a.filter(s=>new Date(s.startTime)<=t)}if(T.value.searchTerm){const t=T.value.searchTerm.toLowerCase();a=a.filter(s=>s.jobId.toLowerCase().includes(t)||s.currentActivity&&s.currentActivity.toLowerCase().includes(t))}return a}),F=R(()=>A.value?"Loading jobs...":$.value?`Error: ${$.value}`:Object.keys(T.value).length>0?"No jobs match the current filters":"No jobs found"),J=async(a=0)=>{try{A.value=!0,$.value=null;let t;h.showPagination?t=await Y.getJobHistory(h.crawlerId,a,h.pageSize):t=await Y.getRecentJobs(h.crawlerId),o.value=t,m.value=t.length,L.value=a}catch(t){$.value=t instanceof Error?t.message:"Failed to load jobs",console.error("Failed to load jobs:",t)}finally{A.value=!1}},U=async()=>{try{E.value=!0,await J(L.value)}finally{E.value=!1}},X=a=>{J(a.page)},z=a=>{_.value=a.sortField,M.value=a.sortOrder,o.value.sort((t,s)=>{const i=le(t,a.sortField),y=le(s,a.sortField);return i<y?-1*a.sortOrder:i>y?1*a.sortOrder:0})},le=(a,t)=>t.split(".").reduce((s,i)=>s&&s[i],a),K=async a=>{try{const t=await Y.getJobDetails(a.jobId);l.value=t,O.value=!0}catch(t){console.error("Failed to load job details:",t),l.value=a,O.value=!0}},ie=async()=>{if(l.value)try{const a=await Y.getJobDetails(l.value.jobId);l.value=a}catch(a){console.error("Failed to refresh job details:",a)}},de=async a=>{try{await Y.cancelJob(a.jobId),await U()}catch(t){console.error("Failed to cancel job:",t),$.value=t instanceof Error?t.message:"Failed to cancel job"}},ce=async a=>{try{await Y.cancelJob(a),await ie(),await U()}catch(t){console.error("Failed to cancel job:",t)}},ee=()=>{T.value={...D.value},S.value=!1},ue=()=>{D.value={status:[],dateFrom:void 0,dateTo:void 0,searchTerm:""},T.value={},S.value=!1},u=a=>{switch(a){case"RUNNING":return"info";case"COMPLETED":return"success";case"FAILED":return"danger";case"CANCELLED":return"warning";default:return"secondary"}},r=a=>`job-status-${a.toLowerCase()}`,I=a=>new Date(a).toLocaleString(),q=a=>{const t=a.durationMs||a.elapsedTimeMs;if(!t)return"-";const s=Math.floor(t/1e3),i=Math.floor(s/60),y=Math.floor(i/60);return y>0?`${y}h ${i%60}m`:i>0?`${i}m ${s%60}s`:`${s}s`},V=a=>a?a.length>30?a.substring(0,30)+"...":a:"-",Q=()=>{g.forEach(a=>a()),g=[],g.push(Me.on("job:updated",a=>{a.crawlerId===h.crawlerId&&te(a)}))},te=a=>{const t=o.value.findIndex(s=>s.jobId===a.jobId);if(t!==-1){const s={...o.value[t]};s.status=a.status,s.lastUpdated=a.timestamp,a.progress&&(s.articlesProcessed=a.progress.articlesProcessed,s.articlesSkipped=a.progress.articlesSkipped,s.articlesFailed=a.progress.articlesFailed,s.currentActivity=a.progress.currentActivity,s.totalArticlesAttempted=a.progress.articlesProcessed+a.progress.articlesSkipped+a.progress.articlesFailed,s.totalArticlesAttempted>0&&(s.successRate=a.progress.articlesProcessed/s.totalArticlesAttempted*100)),o.value[t]=s,l.value&&l.value.jobId===a.jobId&&(l.value=s)}else if(a.type==="job.started"){const s={jobId:a.jobId,crawlerId:a.crawlerId,status:a.status,startTime:a.timestamp,articlesProcessed:0,articlesSkipped:0,articlesFailed:0,elapsedTimeMs:0,successRate:0,totalArticlesAttempted:0,currentActivity:"Starting..."};o.value.unshift(s),!h.showPagination&&o.value.length>10&&(o.value=o.value.slice(0,10))}},pe=()=>{h.autoRefresh&&h.refreshInterval>0&&(n=setInterval(()=>{!A.value&&!O.value&&U()},h.refreshInterval))},se=()=>{n&&(clearInterval(n),n=null)};return Ce(()=>{J(),Q(),pe()}),Se(()=>{g.forEach(a=>a()),se()}),ke(()=>h.crawlerId,()=>{J(),Q()}),(a,t)=>{var fe;const s=H("Button"),i=H("Column"),y=H("Badge"),ae=H("ProgressBar"),oe=H("DataTable"),ve=H("Dialog"),be=H("MultiSelect"),me=H("Calendar"),ge=H("InputText"),re=xe("tooltip");return p(),v("div",zs,[e("div",Vs,[t[7]||(t[7]=e("h3",null,"Job History",-1)),e("div",Ws,[B(d(s,{icon:"pi pi-refresh",severity:"secondary",size:"small",onClick:U,loading:E.value},null,8,["loading"]),[[re,"Refresh job history",void 0,{top:!0}]]),B(d(s,{icon:"pi pi-filter",severity:"secondary",size:"small",onClick:t[0]||(t[0]=f=>S.value=!0)},null,512),[[re,"Filter jobs",void 0,{top:!0}]])])]),e("div",Ys,[d(oe,{value:P.value,loading:A.value,paginator:a.showPagination,rows:a.pageSize,totalRecords:m.value,lazy:a.showPagination,onPage:X,onSort:z,sortMode:"single",sortField:_.value,sortOrder:M.value,size:"small",stripedRows:"",responsiveLayout:"scroll",emptyMessage:F.value,class:"job-history-table"},{default:k(()=>[d(i,{field:"startTime",header:"Started",sortable:""},{body:k(({data:f})=>[e("span",qs,c(I(f.startTime)),1)]),_:1}),d(i,{field:"status",header:"Status",sortable:""},{body:k(({data:f})=>[d(y,{value:f.status,severity:u(f.status),class:W(r(f.status))},null,8,["value","severity","class"])]),_:1}),d(i,{field:"articlesProcessed",header:"Articles",sortable:""},{body:k(({data:f})=>[e("div",Gs,[e("span",Ks,c(f.articlesProcessed),1),f.articlesFailed>0?(p(),v("span",Qs," ("+c(f.articlesFailed)+" failed) ",1)):x("",!0)])]),_:1}),d(i,{field:"successRate",header:"Success Rate",sortable:""},{body:k(({data:f})=>[e("div",Zs,[d(ae,{value:f.successRate,showValue:!1,class:"success-rate-bar"},null,8,["value"]),e("span",Xs,c(f.successRate.toFixed(1))+"%",1)])]),_:1}),d(i,{field:"durationMs",header:"Duration",sortable:""},{body:k(({data:f})=>[e("span",ea,c(q(f)),1)]),_:1}),a.showActivityColumn?(p(),Z(i,{key:0,field:"currentActivity",header:"Activity"},{body:k(({data:f})=>[e("span",{class:"job-activity",title:f.currentActivity},c(V(f.currentActivity)),9,ta)]),_:1})):x("",!0),d(i,{header:"Actions",exportable:!1},{body:k(({data:f})=>[e("div",sa,[B(d(s,{icon:"pi pi-eye",severity:"info",size:"small",text:"",onClick:Ae=>K(f)},null,8,["onClick"]),[[re,"View details",void 0,{top:!0}]]),f.status==="RUNNING"?B((p(),Z(s,{key:0,icon:"pi pi-times",severity:"danger",size:"small",text:"",onClick:Ae=>de(f)},null,8,["onClick"])),[[re,"Cancel job",void 0,{top:!0}]]):x("",!0)])]),_:1})]),_:1},8,["value","loading","paginator","rows","totalRecords","lazy","sortField","sortOrder","emptyMessage"])]),d(ve,{visible:O.value,"onUpdate:visible":t[1]||(t[1]=f=>O.value=f),header:`Job Details - ${(fe=l.value)==null?void 0:fe.jobId}`,modal:"",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:k(()=>[l.value?(p(),Z(Js,{key:0,job:l.value,onRefresh:ie,onCancel:ce},null,8,["job"])):x("",!0)]),_:1},8,["visible","header"]),d(ve,{visible:S.value,"onUpdate:visible":t[6]||(t[6]=f=>S.value=f),header:"Filter Jobs",modal:"",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{footer:k(()=>[d(s,{label:"Clear",severity:"secondary",onClick:ue}),d(s,{label:"Apply",onClick:ee})]),default:k(()=>[e("div",aa,[e("div",oa,[t[8]||(t[8]=e("label",{for:"status-filter"},"Status",-1)),d(be,{id:"status-filter",modelValue:D.value.status,"onUpdate:modelValue":t[2]||(t[2]=f=>D.value.status=f),options:j,optionLabel:"label",optionValue:"value",placeholder:"Select statuses",class:"w-full"},null,8,["modelValue"])]),e("div",ra,[t[9]||(t[9]=e("label",{for:"date-from"},"Date From",-1)),d(me,{id:"date-from",modelValue:D.value.dateFrom,"onUpdate:modelValue":t[3]||(t[3]=f=>D.value.dateFrom=f),showIcon:"",dateFormat:"yy-mm-dd",class:"w-full"},null,8,["modelValue"])]),e("div",na,[t[10]||(t[10]=e("label",{for:"date-to"},"Date To",-1)),d(me,{id:"date-to",modelValue:D.value.dateTo,"onUpdate:modelValue":t[4]||(t[4]=f=>D.value.dateTo=f),showIcon:"",dateFormat:"yy-mm-dd",class:"w-full"},null,8,["modelValue"])]),e("div",la,[t[11]||(t[11]=e("label",{for:"search-term"},"Search",-1)),d(ge,{id:"search-term",modelValue:D.value.searchTerm,"onUpdate:modelValue":t[5]||(t[5]=f=>D.value.searchTerm=f),placeholder:"Search in job ID or activity",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible"])])}}}),da=we(ia,[["__scopeId","data-v-4fbc82fb"]]),ca={class:"crawler-detail"},ua={class:"crawler-detail-container"},pa={class:"surface-0 shadow-2 p-3 border-1 border-50 border-round"},va={class:"flex align-items-center mb-5"},ma={class:"flex-1"},fa={class:"flex align-items-center"},ba={class:"text-900 text-3xl font-medium mr-3"},ga={class:"text-600 text-xl"},ha={class:"flex align-items-center gap-2 flex-wrap"},ya={key:0,class:"flex align-items-center justify-content-center p-6"},wa={key:1,class:"card"},_a={class:"flex align-items-center"},xa={class:"text-sm"},$a={class:"text-center mt-3"},ka={key:2,class:"grid"},Ca={class:"col-12 lg:col-6"},Sa={class:"card h-full"},Da={key:0,class:"grid"},Ta={class:"col-6"},ja={class:"text-900 font-medium"},Ea={class:"col-6"},Ia={class:"text-900 font-medium"},Ra={class:"col-6"},Aa={class:"text-900 font-medium"},Pa={class:"col-6"},Ma={class:"text-900 font-medium"},Fa={class:"col-6"},La={class:"text-900 font-medium"},Na={class:"col-6"},Ba={class:"flex align-items-center"},Ua={class:"col-12 lg:col-6"},Ha={class:"card h-full"},Oa={key:0,class:"grid"},Ja={class:"col-6"},za={class:"flex align-items-center"},Va={class:"col-6"},Wa={class:"text-900 font-medium"},Ya={class:"col-12"},qa={class:"text-900 font-medium"},Ga={key:0,class:"col-12"},Ka={class:"text-900 font-medium"},Qa={class:"col-12"},Za={class:"card"},Xa={key:0,class:"grid"},eo={class:"col-12 md:col-4"},to={class:"flex align-items-center p-2 surface-100 border-round"},so={class:"text-900 text-sm flex-1"},ao={class:"col-12 md:col-4"},oo={class:"flex align-items-center p-2 surface-100 border-round"},ro={class:"text-900 text-sm flex-1"},no={class:"col-12 md:col-4"},lo={class:"flex align-items-center p-2 surface-100 border-round"},io={class:"text-900 text-sm flex-1"},co={key:0,class:"col-12"},uo={class:"card"},po={class:"grid"},vo={class:"col-12 md:col-6"},mo={class:"flex align-items-center"},fo={class:"col-12 md:col-6"},bo={class:"text-900 font-medium"},go={key:0,class:"col-12 md:col-6"},ho={class:"text-900 font-medium"},yo={class:"col-12 md:col-6"},wo={class:"text-900 font-medium"},_o={key:1,class:"col-12"},xo={class:"text-900 font-medium"},$o={key:2,class:"col-12"},ko={class:"text-900 font-medium"},Co={key:3,class:"col-12"},So={class:"text-900 font-medium"},Do={key:1,class:"col-12"},To={class:"card"},jo={key:2,class:"col-12"},Eo={class:"card"},Io={key:3,class:"text-center mt-4"},Ro={class:"text-600"},Ao=_e({__name:"CrawlerDetail",props:{id:{}},setup(b){const h=b,o=Fe(),A=C(!0),E=C(!1),$=C(!1),L=C(null),m=C(null),_=C(null),M=C(null),S=C(null);let D=null,T=null;const O=R(()=>h.id),l=R(()=>{var u;return((u=m.value)==null?void 0:u.name)||h.id}),n=R(()=>{if(!_.value)return"health-unknown";switch(_.value.status){case"HEALTHY":return"health-healthy";case"UNHEALTHY":return"health-unhealthy";default:return"health-unknown"}}),g=R(()=>{if(!_.value)return"pi pi-question-circle";switch(_.value.status){case"HEALTHY":return"pi pi-check-circle";case"UNHEALTHY":return"pi pi-times-circle";default:return"pi pi-question-circle"}}),j=R(()=>{if(!_.value)return"warning";switch(_.value.status){case"HEALTHY":return"success";case"UNHEALTHY":return"danger";default:return"warning"}}),P=R(()=>!_.value||_.value.responseTimeMs===null?"N/A":`${_.value.responseTimeMs}ms`),F=R(()=>{if(!_.value||!_.value.lastCheck)return"Never";const u=new Date(_.value.lastCheck),I=new Date().getTime()-u.getTime(),q=Math.floor(I/1e3),V=Math.floor(q/60);return q<60?`${q}s ago`:V<60?`${V}m ago`:u.toLocaleString()}),J=R(()=>{if(!M.value)return"Never";const r=new Date().getTime()-M.value.getTime(),I=Math.floor(r/1e3);return I<60?`${I}s ago`:I<3600?`${Math.floor(I/60)}m ago`:M.value.toLocaleString()}),U=async()=>{try{L.value=null,A.value=!0;const[u,r]=await Promise.all([Y.getCrawlerConfigurations(),Y.getCrawlerHealth(h.id)]);if(m.value=u.find(I=>I.id===h.id)||null,_.value=r,!m.value)throw new Error(`Crawler with ID '${h.id}' not found`);M.value=new Date}catch(u){console.error("Failed to load crawler details:",u),L.value=u instanceof Error?u.message:"Unknown error occurred",o.add({severity:"error",summary:"Load Error",detail:"Failed to load crawler details",life:5e3})}finally{A.value=!1}},X=async()=>{E.value=!0;try{const u=await Y.forceHealthCheck(h.id);_.value=u,M.value=new Date,o.add({severity:"success",summary:"Health Check",detail:`Forced health check for ${l.value}`,life:3e3})}catch(u){console.error("Failed to force health check:",u),o.add({severity:"error",summary:"Error",detail:"Failed to perform health check",life:5e3})}finally{E.value=!1}},z=async u=>{try{await navigator.clipboard.writeText(u),o.add({severity:"success",summary:"Copied",detail:"URL copied to clipboard",life:2e3})}catch(r){console.error("Failed to copy to clipboard:",r),o.add({severity:"error",summary:"Error",detail:"Failed to copy URL",life:3e3})}},le=()=>{if(m.value){const u=m.value.baseUrl+m.value.healthEndpoint;window.open(u,"_blank")}},K=async()=>{if(m.value){$.value=!0;try{const u=await Y.triggerCrawl(h.id);switch(S.value=u,u.status){case"ACCEPTED":o.add({severity:"success",summary:"Crawl Started",detail:`Crawl initiated successfully for ${l.value}`,life:5e3});break;case"CONFLICT":o.add({severity:"warn",summary:"Crawl Already Running",detail:u.message,life:5e3});break;case"SERVICE_UNAVAILABLE":o.add({severity:"error",summary:"Service Unavailable",detail:u.message,life:5e3});break;case"ERROR":o.add({severity:"error",summary:"Crawl Failed",detail:u.message,life:5e3});break}}catch(u){console.error("Failed to trigger crawl:",u),o.add({severity:"error",summary:"Error",detail:u instanceof Error?u.message:"Failed to trigger crawl",life:5e3})}finally{$.value=!1}}},ie=u=>{switch(u){case"ACCEPTED":return"success";case"CONFLICT":return"warning";case"SERVICE_UNAVAILABLE":case"ERROR":return"danger";default:return"info"}},de=u=>{try{return new Date(u).toLocaleString()}catch{return u}},ce=async()=>{try{const u=await Y.getCrawlerStatus(h.id);o.add({severity:"info",summary:"Crawl Status",detail:`Current status: ${JSON.stringify(u,null,2)}`,life:8e3})}catch(u){console.error("Failed to check crawl status:",u),o.add({severity:"error",summary:"Error",detail:u instanceof Error?u.message:"Failed to check crawl status",life:5e3})}},ee=u=>{u.crawlerId===h.id&&(_.value={status:u.status,message:u.message,lastCheck:u.timestamp,responseTimeMs:null,crawlerId:u.crawlerId},M.value=new Date)},ue=()=>{try{D=new Le,T=D.onHealthUpdate(ee)}catch(u){console.error("Failed to initialize WebSocket:",u)}};return Ce(async()=>{await U(),ue()}),Se(()=>{T&&T(),D&&D.disconnect()}),(u,r)=>{var q,V,Q,te,pe,se;const I=xe("tooltip");return p(),v("div",ca,[e("div",ua,[e("div",pa,[e("div",va,[d(w(N),{icon:"pi pi-arrow-left",class:"p-button-text p-button-plain mr-3",onClick:r[0]||(r[0]=a=>u.$router.push("/"))}),e("div",ma,[e("div",fa,[e("div",ba,c(l.value),1),_.value?(p(),v("div",{key:0,class:W(["health-indicator",n.value])},[e("i",{class:W(g.value)},null,2)],2)):x("",!0)]),e("span",ga,c(O.value),1)]),e("div",ha,[B(d(w(N),{icon:"pi pi-play",label:"Start Crawl",loading:$.value,disabled:!((q=m.value)!=null&&q.enabled)||((V=_.value)==null?void 0:V.status)!=="HEALTHY",onClick:K,class:"p-button-success p-button-sm"},null,8,["loading","disabled"]),[[I,(Q=m.value)!=null&&Q.enabled?((te=_.value)==null?void 0:te.status)!=="HEALTHY"?"Crawler must be healthy to start crawl":"Start a new crawl":"Crawler is disabled",void 0,{bottom:!0}]]),B(d(w(N),{icon:"pi pi-refresh",label:"Force Health Check",loading:E.value,onClick:X,class:"p-button-sm"},null,8,["loading"]),[[I,"Force a health check for this crawler",void 0,{bottom:!0}]]),m.value?B((p(),Z(w(N),{key:0,icon:"pi pi-info-circle",label:"Check Status",class:"p-button-outlined p-button-sm",onClick:ce},null,512)),[[I,"Check current crawl status",void 0,{bottom:!0}]]):x("",!0),m.value?B((p(),Z(w(N),{key:1,icon:"pi pi-external-link",label:"Open Health",class:"p-button-outlined p-button-sm",onClick:le},null,512)),[[I,"Open health endpoint in new tab",void 0,{bottom:!0}]]):x("",!0)])]),A.value?(p(),v("div",ya,[d(w(De)),r[4]||(r[4]=e("span",{class:"ml-3 text-600"},"Loading crawler details...",-1))])):L.value?(p(),v("div",wa,[d(w(je),{severity:"error",closable:!1},{default:k(()=>[e("div",_a,[r[6]||(r[6]=e("i",{class:"pi pi-exclamation-triangle mr-2"},null,-1)),e("div",null,[r[5]||(r[5]=e("div",{class:"font-medium"},"Failed to load crawler details",-1)),e("div",xa,c(L.value),1)])])]),_:1}),e("div",$a,[d(w(N),{icon:"pi pi-refresh",label:"Retry",onClick:U})])])):(p(),v("div",ka,[e("div",Ca,[e("div",Sa,[r[13]||(r[13]=e("h5",{class:"flex align-items-center"},[e("i",{class:"pi pi-cog mr-2"}),G(" Configuration ")],-1)),m.value?(p(),v("div",Da,[e("div",Ta,[r[7]||(r[7]=e("div",{class:"text-600 text-sm mb-1"},"Name",-1)),e("div",ja,c(m.value.name),1)]),e("div",Ea,[r[8]||(r[8]=e("div",{class:"text-600 text-sm mb-1"},"ID",-1)),e("div",Ia,c(m.value.id),1)]),e("div",Ra,[r[9]||(r[9]=e("div",{class:"text-600 text-sm mb-1"},"Base URL",-1)),e("div",Aa,c(m.value.baseUrl),1)]),e("div",Pa,[r[10]||(r[10]=e("div",{class:"text-600 text-sm mb-1"},"Port",-1)),e("div",Ma,c(m.value.port),1)]),e("div",Fa,[r[11]||(r[11]=e("div",{class:"text-600 text-sm mb-1"},"Health Endpoint",-1)),e("div",La,c(m.value.healthEndpoint),1)]),e("div",Na,[r[12]||(r[12]=e("div",{class:"text-600 text-sm mb-1"},"Status",-1)),e("div",Ba,[d(w($e),{value:m.value.enabled?"Enabled":"Disabled",severity:m.value.enabled?"success":"danger",class:"text-xs"},null,8,["value","severity"])])])])):x("",!0)])]),e("div",Ua,[e("div",Ha,[r[18]||(r[18]=e("h5",{class:"flex align-items-center"},[e("i",{class:"pi pi-heart mr-2"}),G(" Health Status ")],-1)),_.value?(p(),v("div",Oa,[e("div",Ja,[r[14]||(r[14]=e("div",{class:"text-600 text-sm mb-1"},"Current Status",-1)),e("div",za,[d(w($e),{value:_.value.status,severity:j.value,class:"text-xs"},null,8,["value","severity"])])]),e("div",Va,[r[15]||(r[15]=e("div",{class:"text-600 text-sm mb-1"},"Response Time",-1)),e("div",Wa,c(P.value),1)]),e("div",Ya,[r[16]||(r[16]=e("div",{class:"text-600 text-sm mb-1"},"Last Check",-1)),e("div",qa,c(F.value),1)]),_.value.message?(p(),v("div",Ga,[r[17]||(r[17]=e("div",{class:"text-600 text-sm mb-1"},"Message",-1)),e("div",Ka,c(_.value.message),1)])):x("",!0)])):x("",!0)])]),e("div",Qa,[e("div",Za,[r[22]||(r[22]=e("h5",{class:"flex align-items-center"},[e("i",{class:"pi pi-link mr-2"}),G(" Endpoints ")],-1)),m.value?(p(),v("div",Xa,[e("div",eo,[r[19]||(r[19]=e("div",{class:"text-600 text-sm mb-2"},"Health Check",-1)),e("div",to,[e("span",so,c(m.value.baseUrl)+c(m.value.healthEndpoint),1),d(w(N),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:r[1]||(r[1]=a=>z(m.value.baseUrl+m.value.healthEndpoint))})])]),e("div",ao,[r[20]||(r[20]=e("div",{class:"text-600 text-sm mb-2"},"Crawl Endpoint",-1)),e("div",oo,[e("span",ro,c(m.value.baseUrl)+c(m.value.crawlEndpoint),1),d(w(N),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:r[2]||(r[2]=a=>z(m.value.baseUrl+m.value.crawlEndpoint))})])]),e("div",no,[r[21]||(r[21]=e("div",{class:"text-600 text-sm mb-2"},"Status Endpoint",-1)),e("div",lo,[e("span",io,c(m.value.baseUrl)+c(m.value.statusEndpoint),1),d(w(N),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:r[3]||(r[3]=a=>z(m.value.baseUrl+m.value.statusEndpoint))})])])])):x("",!0)])]),S.value?(p(),v("div",co,[e("div",uo,[r[30]||(r[30]=e("h5",{class:"flex align-items-center"},[e("i",{class:"pi pi-history mr-2"}),G(" Last Crawl Response ")],-1)),e("div",po,[e("div",vo,[r[23]||(r[23]=e("div",{class:"text-600 text-sm mb-1"},"Status",-1)),e("div",mo,[d(w($e),{value:S.value.status,severity:ie(S.value.status),class:"text-xs"},null,8,["value","severity"])])]),e("div",fo,[r[24]||(r[24]=e("div",{class:"text-600 text-sm mb-1"},"Request ID",-1)),e("div",bo,c(S.value.requestId),1)]),S.value.crawlId?(p(),v("div",go,[r[25]||(r[25]=e("div",{class:"text-600 text-sm mb-1"},"Crawl ID",-1)),e("div",ho,c(S.value.crawlId),1)])):x("",!0),e("div",yo,[r[26]||(r[26]=e("div",{class:"text-600 text-sm mb-1"},"Timestamp",-1)),e("div",wo,c(de(S.value.timestamp)),1)]),S.value.message?(p(),v("div",_o,[r[27]||(r[27]=e("div",{class:"text-600 text-sm mb-1"},"Message",-1)),e("div",xo,c(S.value.message),1)])):x("",!0),S.value.suggestion?(p(),v("div",$o,[r[28]||(r[28]=e("div",{class:"text-600 text-sm mb-1"},"Suggestion",-1)),e("div",ko,c(S.value.suggestion),1)])):x("",!0),S.value.estimatedDuration?(p(),v("div",Co,[r[29]||(r[29]=e("div",{class:"text-600 text-sm mb-1"},"Estimated Duration",-1)),e("div",So,c(S.value.estimatedDuration),1)])):x("",!0)])])])):x("",!0),(pe=m.value)!=null&&pe.enabled?(p(),v("div",Do,[e("div",To,[d(Kt,{"crawler-id":O.value,"auto-refresh":!0,"refresh-interval":3e4},null,8,["crawler-id"])])])):x("",!0),(se=m.value)!=null&&se.enabled?(p(),v("div",jo,[e("div",Eo,[d(da,{"crawler-id":O.value,"show-pagination":!0,"page-size":10,"auto-refresh":!0,"refresh-interval":3e4},null,8,["crawler-id"])])])):x("",!0)])),M.value?(p(),v("div",Io,[e("small",Ro," Last updated: "+c(J.value),1)])):x("",!0)])])])}}}),No=we(Ao,[["__scopeId","data-v-f7245a35"]]);export{No as default};
